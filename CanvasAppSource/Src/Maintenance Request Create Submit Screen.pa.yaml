# ************************************************************************************************
# Warning: YAML source code for Canvas Apps is in preview. The schema is being actively developed.
# Content may be incomplete and subject to change.
# This file is read-only and should only be used to review changes made within Power Apps Studio.
# This file isn't used when loading the app. External editing, merging and conflict resolution are
# not supported.
# 
# For more information, visit https://go.microsoft.com/fwlink/?linkid=2292623
# ************************************************************************************************
Screens:
  Maintenance Request Create Submit Screen:
    Properties:
      Fill: =gblAppColors.Background
      LoadingSpinnerColor: =RGBA(56, 96, 178, 1)
      OnVisible: "=Clear(locMRAttachmentCollection);\r\nIfError(\r\n    //try\r\n    UpdateContext(\r\n        {\r\n            locWOCount: CountRows(\r\n                GroupBy(\r\n                    //Filter with Asset or Functional location\r\n                    If(\r\n                        locCreateMode = C.Creation.CreateFromLocation,\r\n                        Filter(\r\n                            'Asset management work order jobs V2 (mserp)',\r\n                            'Company Code' = locAsset.'Company Code',\r\n                            'Functional location' = locAsset.'Functional location',\r\n                            'Asset management work orders V2'.Active = 'NoYes (mserp)'.Yes\r\n                        ),\r\n                        locCreateMode = C.Creation.CreateFromAsset,\r\n                        Filter(\r\n                            'Asset management work order jobs V2 (mserp)',\r\n                            'Company Code' = locAsset.'Company Code',\r\n                            Asset = locAsset.'Asset (mserp_maintenanceassetid)',\r\n                            'Asset management work orders V2'.Active = 'NoYes (mserp)'.Yes\r\n                        )\r\n                    ),\r\n                    'Work order',\r\n                    WorkOrderJobs\r\n                )\r\n            )\r\n        }\r\n    ),\r\n    //catch\r\n    UpdateContext({locWOCount: Blank()});\r\n    Notify(\r\n        Match(\r\n            FirstError.Details.HttpResponse,\r\n            \"\\\"\"code\"\":\"\"(?<code>[^\"\"]*)\"\",\"\"message\"\":\"\"(?<message>[^\"\"]*)\"\r\n        ).message,\r\n        NotificationType.Error\r\n    );\r\n    \r\n);\r\nIfError(\r\n    UpdateContext(\r\n        {\r\n            locMRCount: CountRows(\r\n                If(\r\n                    locCreateMode = C.Creation.CreateFromLocation,\r\n                    Filter(\r\n                        'Maintenance Requests',\r\n                        'Functional location' = locLocation.'Functional location (mserp_functionallocationid)',\r\n                        'Company Code' = locLocation.'Company Code',\r\n                        Active = 'NoYes (mserp)'.Yes\r\n                    ),\r\n                    locCreateMode = C.Creation.CreateFromAsset,\r\n                    Filter(\r\n                        'Maintenance Requests',\r\n                        Asset = locAsset.'Asset (mserp_maintenanceassetid)',\r\n                        'Company Code' = locAsset.'Company Code',\r\n                        Active = 'NoYes (mserp)'.Yes\r\n                    )\r\n                )\r\n            )\r\n        }\r\n    ),\r\n    //catch\r\n    UpdateContext({locMRCount: Blank()});\r\n    Notify(\r\n        Match(\r\n            FirstError.Details.HttpResponse,\r\n            \"\\\"\"code\"\":\"\"(?<code>[^\"\"]*)\"\",\"\"message\"\":\"\"(?<message>[^\"\"]*)\"\r\n        ).message,\r\n        NotificationType.Error\r\n    );\r\n    \r\n);\r\n\r\nSet(gblPreviousScreen, Self)"
    Children:
      - conVerticalCreateRequest:
          Control: GroupContainer@1.3.0
          Variant: AutoLayout
          Properties:
            DropShadow: =DropShadow.None
            Height: =Parent.Height - btnCreateMRSubmit.Height -16
            LayoutDirection: =LayoutDirection.Vertical
            LayoutOverflowY: =LayoutOverflow.Scroll
            PaddingBottom: =10
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Width: =Parent.Width
          Children:
            - conCreateMRHeader:
                Control: GroupContainer@1.3.0
                Variant: ManualLayout
                Properties:
                  AlignInContainer: =AlignInContainer.SetByContainer
                  DropShadow: =DropShadow.None
                  FillPortions: =0
                  Height: =52
                  RadiusBottomLeft: =0
                  RadiusBottomRight: =0
                  RadiusTopLeft: =0
                  RadiusTopRight: =0
                  Width: =Parent.Width
                Children:
                  - lblCreateMRHeader:
                      Control: Label@2.5.1
                      Properties:
                        Align: =Align.Center
                        BorderColor: =RGBA(0, 18, 107, 1)
                        Color: =RGBA(255, 255, 255, 1)
                        Fill: =gblAppStyles.Header.Fill
                        Font: =gblAppStyles.CommonFont
                        FontWeight: =gblAppStyles.Header.FontWeight
                        Height: =54
                        PaddingLeft: =icoCreateMRBackButton.Width
                        PaddingRight: =icoCreateMRBackButton.Width
                        Size: =gblAppStyles.Header.FontSize
                        Text: |-
                          =//pal-disable PAL004
                          If(locCreateMode = C.Creation.CreateFromLocation, locLocation.mserp_name &" "&locLocation.mserp_functionallocationid,locCreateMode = C.Creation.CreateFromAsset,locAsset.mserp_name &" "&locAsset.mserp_maintenanceassetid)
                        Width: =Parent.Width
                        Wrap: =false
                        X: =
                  - icoCreateMRBackButton:
                      Control: Classic/Icon@2.5.0
                      Properties:
                        AccessibleLabel: =T.BackButtonAccessibleLabel
                        BorderColor: =RGBA(0, 18, 107, 1)
                        Color: =Color.White
                        FocusedBorderColor: =gblAppStyles.FocusBorderColor
                        FocusedBorderThickness: =gblAppStyles.FocusBorderThickness
                        Height: =Parent.Height
                        Icon: =Icon.ChevronLeft
                        OnSelect: |+
                          =Concurrent(
                              Reset(cmpCreateMRDescription),
                              Reset(cmpCreateMRNotes),
                              Reset(drpCreateMRServiceLevel),
                              Reset(drpCreateMRRequestType)
                          );
                          Back();

                        PaddingBottom: =16
                        PaddingLeft: =16
                        PaddingRight: =16
                        PaddingTop: =16
                        TabIndex: =0
                        Width: =56
                        X: =2
                        Y: =2
            - conCreateMRSubHeader:
                Control: GroupContainer@1.3.0
                Variant: AutoLayout
                Properties:
                  AlignInContainer: =AlignInContainer.SetByContainer
                  DropShadow: =DropShadow.None
                  Fill: =gblAppStyles.Header.Fill
                  FillPortions: =0
                  Height: =If(Self.Width <= conCreateMRSubHeader.LayoutMinWidth ,gblAppStyles.Pills.Height * 2 + 20 ,62)
                  LayoutAlignItems: =LayoutAlignItems.Center
                  LayoutDirection: =If(Self.Width <= conCreateMRSubHeader.LayoutMinWidth ,LayoutDirection.Vertical,LayoutDirection.Horizontal)
                  LayoutGap: =10
                  LayoutMinWidth: =340
                  PaddingLeft: =16
                  PaddingRight: =16
                  RadiusBottomLeft: =0
                  RadiusBottomRight: =0
                  RadiusTopLeft: =0
                  RadiusTopRight: =0
                  Width: =Parent.Width
                Children:
                  - conCreateMRWorkOrders:
                      Control: GroupContainer@1.3.0
                      Variant: ManualLayout
                      Properties:
                        AlignInContainer: =AlignInContainer.SetByContainer
                        DropShadow: =DropShadow.None
                        FillPortions: =0
                        Height: =42
                        LayoutMinWidth: =100
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopLeft: =0
                        RadiusTopRight: =0
                        Width: =btnCreateMRWorkOrders.Width + 4
                      Children:
                        - btnCreateMRWorkOrders:
                            Control: Classic/Button@2.2.0
                            Properties:
                              BorderColor: =ColorFade(Self.Fill, -15%)
                              BorderThickness: =0
                              Color: =gblAppStyles.Pills.FontColor
                              DisabledBorderColor: =RGBA(166, 166, 166, 1)
                              DisabledColor: =gblAppStyles.Pills.DisabledColor
                              DisabledFill: =gblAppStyles.Pills.DisabledFill
                              DisplayMode: |-
                                =If(
                                    locWOCount > 0,
                                    DisplayMode.Edit,
                                    DisplayMode.Disabled
                                )
                              Fill: =gblAppStyles.Pills.Fill
                              FocusedBorderColor: =gblAppStyles.FocusBorderColor
                              FocusedBorderThickness: =gblAppStyles.FocusBorderThickness
                              Font: =gblAppStyles.Pills.Font
                              FontWeight: =gblAppStyles.Pills.FontWeight
                              Height: =gblAppStyles.Pills.Height
                              HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                              HoverColor: =RGBA(255, 255, 255, 1)
                              HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                              OnSelect: |-
                                =If(
                                    locCreateMode = C.Creation.CreateFromAsset,
                                    Navigate(
                                        'Maintenance Request Work Order List Screen',
                                        ScreenTransition.None,
                                        {locCreateMode :locCreateMode, locAsset:locAsset}
                                    ),
                                    locCreateMode = C.Creation.CreateFromLocation,
                                    Navigate(
                                        'Maintenance Request Work Order List Screen',
                                        ScreenTransition.None,
                                        {locCreateMode :locCreateMode, locLocation:locLocation}
                                    ),
                                    Trace("Context missing for MR creation", TraceSeverity.Error, {CreateMode:locCreateMode})
                                )
                              PaddingLeft: =Len(Self.Text)*1.2
                              PaddingRight: =0
                              PressedBorderColor: =
                              PressedColor: =gblAppStyles.Pills.PressedColor
                              PressedFill: =gblAppStyles.Pills.PressedFill
                              RadiusBottomLeft: =1000
                              RadiusBottomRight: =1000
                              RadiusTopLeft: =1000
                              RadiusTopRight: =1000
                              Size: =gblAppStyles.FontSize_Medium
                              Text: |-
                                =If(
                                    IsBlankOrError(locWOCount),
                                    T.MaintenanceWorkOrdersExistingLabel,
                                    Substitute(
                                        T.MaintenanceWorkOrdersExistingCountLabel,
                                        "{ExistingWorkOrdersCount}",
                                        If(
                                            locWOCount > 99,
                                            "99+",
                                            locWOCount
                                        )
                                    )
                                )
                              X: =1
                              Y: =2
                        - icoCreateMRWorkOrders:
                            Control: Classic/Icon@2.5.0
                            Properties:
                              BorderColor: =RGBA(0, 18, 107, 1)
                              Color: =gblAppColors.AccentInfo3
                              Fill: =RGBA(0,0,0,0)
                              Height: =17
                              Icon: =Icon.DetailList
                              OnSelect: =Select(btnCreateMRWorkOrders);
                              PaddingRight: =5
                              PressedFill: =gblAppStyles.Pills.PressedFill
                              Width: =29
                              X: =7
                              Y: =11
                  - conCreateMRRequests:
                      Control: GroupContainer@1.3.0
                      Variant: ManualLayout
                      Properties:
                        AlignInContainer: =AlignInContainer.SetByContainer
                        DropShadow: =DropShadow.None
                        FillPortions: =0
                        Height: =42
                        LayoutMinWidth: =100
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopLeft: =0
                        RadiusTopRight: =0
                        Width: =btnCreateMRRequests.Width + 4
                      Children:
                        - btnCreateMRRequests:
                            Control: Classic/Button@2.2.0
                            Properties:
                              BorderColor: =ColorFade(Self.Fill, -15%)
                              BorderThickness: =0
                              Color: =gblAppStyles.Pills.FontColor
                              DisabledBorderColor: =RGBA(166, 166, 166, 1)
                              DisabledColor: =gblAppStyles.Pills.DisabledColor
                              DisabledFill: =gblAppStyles.Pills.DisabledFill
                              DisplayMode: |-
                                =If(
                                    locMRCount > 0,
                                    DisplayMode.Edit,
                                    DisplayMode.Disabled
                                )
                              Fill: =gblAppStyles.Pills.Fill
                              FocusedBorderColor: =gblAppStyles.FocusBorderColor
                              FocusedBorderThickness: =gblAppStyles.FocusBorderThickness
                              Font: =gblAppStyles.Pills.Font
                              FontWeight: =gblAppStyles.Pills.FontWeight
                              Height: =gblAppStyles.Pills.Height
                              HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                              HoverColor: =RGBA(255, 255, 255, 1)
                              HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                              OnSelect: |-
                                =If(
                                    locCreateMode = C.Creation.CreateFromAsset,
                                    Navigate(
                                        'Maintenance Requests List Screen',
                                        ScreenTransition.None,
                                        {locCreateMode :locCreateMode, locAsset:locAsset}
                                    ),
                                    locCreateMode = C.Creation.CreateFromLocation,
                                    Navigate(
                                        'Maintenance Requests List Screen',
                                        ScreenTransition.None,
                                        {locCreateMode :locCreateMode, locLocation:locLocation}
                                    ),
                                    Trace("Context missing for MR creation", TraceSeverity.Error, {CreateMode:locCreateMode})
                                )
                              PaddingLeft: =Len(Self.Text)*1.5
                              PaddingRight: =0
                              PressedBorderColor: =
                              PressedColor: =gblAppStyles.Pills.PressedColor
                              PressedFill: =gblAppStyles.Pills.PressedFill
                              RadiusBottomLeft: =1000
                              RadiusBottomRight: =1000
                              RadiusTopLeft: =1000
                              RadiusTopRight: =1000
                              Size: =gblAppStyles.Pills.FontSize
                              Text: |-
                                =If(
                                    IsBlankOrError(locMRCount),
                                    T.MaintenanceRequestsExistingLabel,
                                    Substitute(
                                        T.MaintenanceRequestsExistingCountLabel,
                                        "{ExistingRequestsCount}",
                                        If(
                                            locMRCount > 99,
                                            "99+",
                                            locMRCount
                                        )
                                    )
                                )
                              Width: =135
                              X: =2
                              Y: =2
                        - icoCreateMRRequests:
                            Control: Classic/Icon@2.5.0
                            Properties:
                              BorderColor: =RGBA(0, 18, 107, 1)
                              Color: =ColorValue("#3280AB")
                              Fill: =RGBA(0,0,0,0)
                              Height: =17
                              Icon: =Icon.ToolsWrench
                              OnSelect: =Select(btnCreateMRRequests)
                              PaddingRight: =5
                              PressedFill: =gblAppStyles.Pills.PressedFill
                              Width: =29
                              X: =7
                              Y: =11
            - conCreateMRForm:
                Control: GroupContainer@1.3.0
                Variant: AutoLayout
                Properties:
                  DropShadow: =DropShadow.None
                  LayoutAlignItems: =LayoutAlignItems.Stretch
                  LayoutDirection: =LayoutDirection.Vertical
                  LayoutGap: =16
                  LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
                  LayoutOverflowY: =LayoutOverflow.Scroll
                  PaddingBottom: =16
                  PaddingLeft: =gblAppStyles.Padding.Left
                  PaddingRight: =gblAppStyles.Padding.Right
                  PaddingTop: =16
                  RadiusBottomLeft: =0
                  RadiusBottomRight: =0
                  RadiusTopLeft: =0
                  RadiusTopRight: =0
                  Width: =Parent.Width
                Children:
                  - lblCreateMRIntro:
                      Control: Label@2.5.1
                      Properties:
                        BorderColor: =RGBA(0, 18, 107, 1)
                        Color: =gblAppColors.PrimaryText
                        Font: =gblAppStyles.CommonFont
                        Height: =25
                        PaddingBottom: =0
                        PaddingTop: =0
                        Size: =gblAppStyles.FontSize_Large
                        Text: =T.MRCreationInstructionLabel
                        Width: =Parent.Width
                  - cmpCreateMRDescription:
                      Control: CanvasComponent
                      ComponentName: TextInputWithLabel
                      Properties:
                        AccessibleLabel: =T.MRDescriptionAccessibleLabel
                        DefaultText: =Blank()
                        Fill: =Self.backgroundColor
                        Height: =54
                        HorizontalPadding: =8
                        LayoutMinHeight: =40
                        LayoutMinWidth: =11
                        MaxLength: =60
                        Width: =Parent.Width - Parent.PaddingLeft*2
                        Y: =16
                        backgroundColor: =gblAppColors.Neutral
                        dividerColor: =gblAppColors.AccentLink
                        labelColor: =gblAppStyles.Label.FontColor
                        labelFontSize: =gblAppStyles.Label.FontSize
                        labelText: =T.MRDescriptionHeaderLabel
                        multiLine: =false
                        textColor: =RGBA(0, 0, 0, 1)
                        textFont: =gblAppStyles.Label.Font
                        textFontSize: =gblAppStyles.FontSize_Large
                  - cmpCreateMRNotes:
                      Control: CanvasComponent
                      ComponentName: TextInputWithLabel
                      Properties:
                        AccessibleLabel: =T.MRNotesAccessibleLabel
                        DefaultText: =Blank()
                        Fill: =Self.backgroundColor
                        Height: =108
                        HorizontalPadding: =8
                        LayoutMinHeight: =50
                        LayoutMinWidth: =10
                        MaxLength: =Blank()
                        Width: =Parent.Width - Parent.PaddingLeft*2
                        Y: =16
                        backgroundColor: =gblAppColors.Neutral
                        dividerColor: =gblAppColors.AccentLink
                        labelColor: =gblAppStyles.Label.FontColor
                        labelFontSize: =gblAppStyles.Label.FontSize
                        labelText: =T.MRNotesHeaderLabel
                        multiLine: =true
                        textColor: =gblAppColors.PrimaryText
                        textFont: =gblAppStyles.DefaultText.Font
                        textFontSize: =gblAppStyles.FontSize_Large
                  - conCreateMRServiceLevel:
                      Control: GroupContainer@1.3.0
                      Variant: ManualLayout
                      Properties:
                        AlignInContainer: =AlignInContainer.Center
                        DropShadow: =DropShadow.None
                        Fill: =gblAppColors.Neutral
                        FillPortions: =0
                        Height: =72
                        LayoutMinHeight: =60
                        PaddingBottom: =(conCreateMRServiceLevel.Height - lblCreateMRServiceLevel.Height - drpCreateMRServiceLevel.Height)/2
                        PaddingTop: =(conCreateMRServiceLevel.Height - lblCreateMRServiceLevel.Height - drpCreateMRServiceLevel.Height)/2
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopLeft: =0
                        RadiusTopRight: =0
                        Width: =Parent.Width - Parent.PaddingLeft*2
                      Children:
                        - shpNewMRServiceLevelBottomBorder:
                            Control: Rectangle@2.3.0
                            Properties:
                              BorderColor: =RGBA(0, 18, 107, 1)
                              Fill: =gblAppColors.AccentLink
                              Height: =2
                              Width: =Parent.Width
                              Y: =Parent.Height - Self.Height
                        - drpCreateMRServiceLevel:
                            Control: Classic/DropDown@2.3.1
                            Properties:
                              AccessibleLabel: =T.MRServiceLevelAccessibleLabel
                              BorderColor: =RGBA(0, 18, 107, 1)
                              BorderThickness: =0
                              ChevronBackground: =RGBA(255, 255, 255, 1)
                              ChevronFill: =gblAppColors.Accent
                              ChevronHoverBackground: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                              ChevronHoverFill: =RGBA(255, 255, 255, 1)
                              Color: =gblAppColors.Accent
                              Default: =locDefaultServiceLevel
                              FocusedBorderColor: =gblAppStyles.FocusBorderColor
                              FocusedBorderThickness: =gblAppStyles.FocusBorderThickness
                              Font: =gblAppStyles.CommonFont
                              Height: =32
                              HoverFill: =RGBA(186, 202, 226, 1)
                              Items: |-
                                =Switch(
                                    locCreateMode,
                                    C.Creation.CreateFromAsset,
                                    Filter('Work Order Service Levels', mserp_dataareaid = locAsset.mserp_dataareaid),
                                    C.Creation.CreateFromLocation,
                                    Filter('Work Order Service Levels', mserp_dataareaid = locLocation.mserp_dataareaid)
                                )
                              Items.Value: =mserp_formattedservicelevelname
                              PaddingLeft: =8
                              PressedColor: =Self.Color
                              PressedFill: =gblAppColors.Neutral
                              SelectionColor: =RGBA(255, 255, 255, 1)
                              SelectionFill: =gblAppColors.Accent
                              Size: =gblAppStyles.FontSize_Large
                              Width: =Parent.Width-8
                              Y: =27
                        - lblCreateMRServiceLevel:
                            Control: Label@2.5.1
                            Properties:
                              BorderColor: =RGBA(0, 18, 107, 1)
                              Color: =gblAppStyles.Label.FontColor
                              Font: =gblAppStyles.Label.Font
                              Height: =27
                              PaddingLeft: =8
                              Size: =gblAppStyles.Label.FontSize
                              Text: =T.ServiceLevelLabel
                              Width: =225
                  - conCreateMRRequestType:
                      Control: GroupContainer@1.3.0
                      Variant: ManualLayout
                      Properties:
                        AlignInContainer: =AlignInContainer.Center
                        DropShadow: =DropShadow.None
                        Fill: =gblAppColors.Neutral
                        FillPortions: =0
                        Height: =72
                        LayoutMinHeight: =60
                        PaddingLeft: =8
                        PaddingRight: =10
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopLeft: =0
                        RadiusTopRight: =0
                        Width: =Parent.Width - Parent.PaddingLeft*2
                      Children:
                        - shpNewMRRequestTypeBottomBorder:
                            Control: Rectangle@2.3.0
                            Properties:
                              BorderColor: =RGBA(0, 18, 107, 1)
                              Fill: =gblAppColors.AccentLink
                              Height: =2
                              Width: =Parent.Width
                              Y: =Parent.Height - Self.Height
                        - drpCreateMRRequestType:
                            Control: Classic/DropDown@2.3.1
                            Properties:
                              AccessibleLabel: =T.MRRequestTypeAccessibleLabel
                              BorderColor: =RGBA(0, 18, 107, 1)
                              BorderThickness: =0
                              ChevronBackground: =RGBA(255, 255, 255, 1)
                              ChevronFill: =gblAppColors.Accent
                              ChevronHoverBackground: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                              ChevronHoverFill: =RGBA(255, 255, 255, 1)
                              Color: =gblAppColors.Accent
                              Default: =locDefaultRequestType
                              FocusedBorderColor: =gblAppStyles.FocusBorderColor
                              FocusedBorderThickness: =gblAppStyles.FocusBorderThickness
                              Font: =gblAppStyles.CommonFont
                              Height: =31
                              HoverFill: =RGBA(186, 202, 226, 1)
                              Items: |-
                                =Switch(
                                    locCreateMode,
                                    C.Creation.CreateFromAsset,
                                    Filter(
                                        'Maintenance Request Types',
                                        mserp_dataareaid = locAsset.mserp_dataareaid
                                    ),
                                    C.Creation.CreateFromLocation,
                                    Filter(
                                        'Maintenance Request Types',
                                        mserp_dataareaid = locLocation.mserp_dataareaid
                                    )
                                )
                              Items.Value: =mserp_requesttypeid
                              PaddingLeft: =8
                              PressedColor: =Self.Color
                              PressedFill: =gblAppColors.Neutral
                              SelectionColor: =RGBA(255, 255, 255, 1)
                              SelectionFill: =gblAppColors.Accent
                              Size: =gblAppStyles.FontSize_Large
                              Width: =Parent.Width-8
                              Y: =27
                        - lblCreateMRRequestType:
                            Control: Label@2.5.1
                            Properties:
                              BorderColor: =RGBA(0, 18, 107, 1)
                              Color: =gblAppStyles.Label.FontColor
                              Font: =gblAppStyles.Label.Font
                              Height: =27
                              PaddingLeft: =8
                              Size: =gblAppStyles.Label.FontSize
                              Text: =T.MRRequestTypeHeaderLabel
                              Width: =Parent.Width
                  - imgCreateMRAddImage:
                      Control: Image@2.2.3
                      Group: grpCreateMRAddImage
                      Properties:
                        ApplyEXIFOrientation: =false
                        BorderColor: =RGBA(0, 18, 107, 1)
                        Height: =Self.Width
                        Image: =If(!IsBlank(btnCreateMRAddImage.Media), btnCreateMRAddImage.Media)
                        LayoutMinHeight: =50
                        Visible: =false
                        Width: =Min(300,Parent.Width -16*2)
                        X: =btnCreateMRAddImage.X
                        Y: =btnCreateMRAddImage.Y
                  - galMRCreateAttachments:
                      Control: Gallery@2.15.0
                      Variant: BrowseLayout_Horizontal_TwoTextOneImageVariant_ver4.0
                      Properties:
                        AccessibleLabel: =T.MRAttachmentsAccessibleLabel
                        BorderColor: =RGBA(0, 18, 107, 1)
                        DelayItemLoading: =false
                        Height: =260
                        Items: =locMRAttachmentCollection
                        LayoutMinHeight: =260
                        LayoutMinWidth: =300
                        LoadingSpinner: =LoadingSpinner.None
                        TemplateSize: =Min(440, Self.Height - 60)
                        Visible: =Not IsEmpty(locMRAttachmentCollection)
                      Children:
                        - imgMRCreateAttachments:
                            Control: Image@2.2.3
                            Properties:
                              ApplyEXIFOrientation: =false
                              BorderColor: =RGBA(0, 18, 107, 1)
                              Height: =imgMRCreateAttachments.Width
                              Image: =ThisItem.Value
                              ImagePosition: =ImagePosition.Stretch
                              OnSelect: =Select(Parent)
                              Width: =Parent.TemplateWidth - 16
                              Y: =16
                        - imgRemoveImage:
                            Control: Image@2.2.3
                            Properties:
                              AccessibleLabel: =T.RemoveItemIconAccessibleLabel
                              BorderColor: =RGBA(0, 18, 107, 1)
                              Height: =36
                              Image: =removeImage
                              OnSelect: =Remove(locMRAttachmentCollection,ThisItem)
                              PressedFill: =ColorFade(Self.Fill, -30%)
                              Width: =36
                              X: =imgMRCreateAttachments.Width - imgRemoveImage.Width -5
                              Y: =imgMRCreateAttachments.Y + 5
                  - btnCreateMRAddImage:
                      Control: AddMedia@2.2.1
                      Group: grpCreateMRAddImage
                      Properties:
                        AccessibleLabel: =T.MRAddImageAccessibleLabel
                        BorderColor: =gblAppColors.Primary
                        ChangePictureText: =T.MRAddImageButtonLabel
                        Color: =gblAppColors.Primary
                        Fill: =gblAppColors.Background
                        FocusedBorderColor: =gblAppStyles.FocusBorderColor
                        FocusedBorderThickness: =gblAppStyles.FocusBorderThickness
                        Font: =gblAppStyles.CommonFont
                        Height: =gblAppStyles.Button.Height
                        LayoutMinHeight: =50
                        LayoutMinWidth: =100
                        OnSelect: |+
                          =UpdateContext({ locImageData: JSON(imgCreateMRAddImage.Image, JSONFormat.IncludeBinaryData) });
                          UpdateContext({ locImageBase64: Mid(locImageData, Find(",", locImageData) + 1, Len(locImageData) - Find(",", locImageData) - 1) });
                          UpdateContext({ locFileExtension: Mid(locImageData, Find("/", locImageData) + 1, Find(";base64,", locImageData) - Find("/", locImageData) - 1) });

                          If(
                              Len(locImageBase64) >= DataSourceInfo(
                                  'Asset management maintenance request document attachments entity (mserp)',
                                  DataSourceInfo.MaxLength,
                                  Bitmap
                              ),
                              Notify(T.Error_PhotoTooLargeToAttach, NotificationType.Warning),
                              Collect(
                                  locMRAttachmentCollection,
                                  {
                                      Value: btnCreateMRAddImage.Media,
                                      ImageData: locImageData,
                                      ImageBase64: locImageBase64,
                                      FileExtension: locFileExtension,
                                      FileName: GUID() & "." & locFileExtension
                                  }
                              )
                          )

                        Padding: =10
                        Size: =gblAppStyles.Button.FontSize
                        Text: =T.MRAddImageButtonLabel
                        Width: =Min(300,Parent.Width -16*2)
                        X: =40
                        Y: =40
      - btnCreateMRSubmit:
          Control: Classic/Button@2.2.0
          Properties:
            BorderColor: =ColorFade(Self.Fill, -15%)
            BorderThickness: =0
            Color: =gblAppStyles.Button.FontColor
            DisabledBorderColor: =RGBA(166, 166, 166, 1)
            Fill: =gblAppStyles.Button.Fill
            FocusedBorderColor: =gblAppStyles.FocusBorderColor
            FocusedBorderThickness: =gblAppStyles.FocusBorderThickness
            Font: =gblAppStyles.CommonFont
            FontWeight: =gblAppStyles.Button.FontWeight
            Height: =gblAppStyles.Button.Height
            HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
            HoverColor: =RGBA(255, 255, 255, 1)
            HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
            OnSelect: "=UpdateContext (\n    {\n        locCreatedRequest: Patch(\n            'Maintenance Requests',\n            Defaults('Maintenance Requests'),\n            If(\n                locCreateMode = C.Creation.CreateFromAsset,\n                {\n                    Description: cmpCreateMRDescription.Text,\n                    Note: cmpCreateMRNotes.Text,\n                    'Service level': drpCreateMRServiceLevel.Selected.'Service level',\n                    'Maintenance request type': drpCreateMRRequestType.Selected.'Maintenance request type',\n                    'Company Code': locAsset.'Company Code',\n                    'Functional location': locAsset.'Functional location',\n                    Asset: locAsset.'Asset (mserp_maintenanceassetid)',\n                    'Actual start': DateAdd( // UserTime => UTC\n                        Now(),\n                        TimeZoneOffset(),\n                        TimeUnit.Minutes\n                    )\n                },\n                locCreateMode = C.Creation.CreateFromLocation,\n                {\n                    Description: cmpCreateMRDescription.Text,\n                    Note: cmpCreateMRNotes.Text,\n                    'Service level': drpCreateMRServiceLevel.Selected.'Service level',\n                    'Maintenance request type': drpCreateMRRequestType.Selected.'Maintenance request type',\n                    'Company Code': locLocation.'Company Code',\n                    'Functional location': locLocation.'Functional location (mserp_functionallocationid)',\n                    'Actual start': DateAdd( // UserTime => UTC\n                        Now(),\n                        TimeZoneOffset(),\n                        TimeUnit.Minutes\n                    )\n                },\n                {}\n            )\n        )\n    }\n);\nIfError (\n        //try\n    locCreatedRequest,\n        //On error\n    Notify(\n        Match(\n            FirstError.Details.HttpResponse,\n            \"\\\"\"code\"\":\"\"(?<code>[^\"\"]*)\"\",\"\"message\"\":\"\"(?<message>[^\"\"]*)\"\n        ).message,\n        NotificationType.Error\n    ),\n    If(\n        !IsEmpty(locMRAttachmentCollection) And !IsBlank(locCreatedRequest),\n        UpdateContext(\n            {\n                locDocuTypes: ShowColumns(\n                    Filter(\n                        'Document types (mserp)',\n                        'Company Code' = locCreatedRequest.'Company Code'\n                    ),\n                    ActionClassName,\n                    'Company Code',\n                    Type\n                )\n            }\n        );\n        UpdateContext(\n            {\n                locDocuType: LookUp(\n                    locDocuTypes,\n                    mserp_actionclassname = \"DocuActionArchive\"\n                )\n            }\n        );\n        If(\n            IsBlankOrError(locDocuType),\n                //System is not configured for file attachments\n            Notify(T.Error_AttachmentCreationFailureFromMissingDocumentTypeConfiguration);\n            Trace(\n                \"Unable to create attachments as document type configuration is missing\",\n                TraceSeverity.Error\n            ),\n            UpdateContext(\n                {\n                    locImageBase64: Mid(\n                        locImageData,\n                        Find(\n                            \",\",\n                            locImageData\n                        ) + 1,\n                        Len(locImageData) - Find(\n                            \",\",\n                            locImageData\n                        ) - 1\n                    )\n                }\n            );\n            UpdateContext(\n                {\n                    locFileExtension: Mid(\n                        locImageData,\n                        Find(\n                            \"/\",\n                            locImageData\n                        ) + 1,\n                        Find(\n                            \";base64,\",\n                            locImageData\n                        ) - Find(\n                            \"/\",\n                            locImageData\n                        ) - 1\n                    )\n                }\n            );\n            ForAll(\n                locMRAttachmentCollection As attachment,\n                Patch(\n                    'Asset management maintenance request document attachments entity (mserp)',\n                    Defaults('Asset management maintenance request document attachments entity (mserp)'),\n                    {\n                        'Company Code': locCreatedRequest.'Company Code',\n                        DocumentAttachmentTypeLegalEntityId: locDocuType.mserp_dataareaid,\n                        Type: locDocuType.mserp_id,\n                        Bitmap: attachment.ImageBase64,\n                        'Original file name': attachment.FileName,\n                        'Maintenance request': locCreatedRequest.'Maintenance request',\n                        Description: attachment.FileName\n                    }\n                )\n            );\n        )\n    );\n    Clear(locMRAttachmentCollection);\n    Reset(cmpCreateMRDescription);\n    Reset(cmpCreateMRNotes);\n    Reset(drpCreateMRServiceLevel);\n    Reset(drpCreateMRRequestType);\n    Navigate(\n        'Creation Success Screen',\n        ScreenTransition.None,\n        {\n            locHeaderText: lblCreateMRHeader.Text,\n            locCreatedId: locCreatedRequest.'Maintenance request',\n            locCreatedType: C.Creation.CreateMaintenanceRequest\n        }\n    );\n    \n);\n"
            PressedBorderColor: =Self.Fill
            PressedColor: =Self.Fill
            PressedFill: =Self.Color
            Size: =gblAppStyles.Button.FontSize
            Text: =T.SubmitButtonLabel
            Width: =Min(300,Parent.Width -16*2)
            X: =(Parent.Width / 2) - (Self.Width/2)
            Y: =conVerticalCreateRequest.Height
